import{n as Ce,m as _e,d as x,j as Q,b as We,c as L,_ as Xe}from"./@babel.41e769f8.js";import{r as i}from"./react.626956fd.js";import{c as Z}from"./classnames.baa81988.js";import{H as je,w as Ye,c as ze,e as De,f as Je,K as O}from"./rc-util.135a5bed.js";function ee(){return typeof BigInt=="function"}function F(e){var r=e.trim(),t=r.startsWith("-");t&&(r=r.slice(1)),r=r.replace(/(\.\d*[^0])0*$/,"$1").replace(/\.0*$/,"").replace(/^0+/,""),r.startsWith(".")&&(r="0".concat(r));var u=r||"0",s=u.split("."),c=s[0]||"0",m=s[1]||"0";c==="0"&&m==="0"&&(t=!1);var f=t?"-":"";return{negative:t,negativeStr:f,trimStr:u,integerStr:c,decimalStr:m,fullStr:"".concat(f).concat(u)}}function re(e){var r=String(e);return!Number.isNaN(Number(r))&&r.includes("e")}function q(e){var r=String(e);if(re(e)){var t=Number(r.slice(r.indexOf("e-")+2)),u=r.match(/\.(\d+)/);return u!=null&&u[1]&&(t+=u[1].length),t}return r.includes(".")&&ae(r)?r.length-r.indexOf(".")-1:0}function ne(e){var r=String(e);if(re(e)){if(e>Number.MAX_SAFE_INTEGER)return String(ee()?BigInt(e).toString():Number.MAX_SAFE_INTEGER);if(e<Number.MIN_SAFE_INTEGER)return String(ee()?BigInt(e).toString():Number.MIN_SAFE_INTEGER);r=e.toFixed(q(r))}return F(r).fullStr}function ae(e){return typeof e=="number"?!Number.isNaN(e):e?/^\s*-?\d+(\.\d+)?\s*$/.test(e)||/^\s*-?\d+\.\s*$/.test(e)||/^\s*-?\.\d+\s*$/.test(e):!1}var Qe=function(){function e(r){if(_e(this,e),this.origin="",this.number=void 0,this.empty=void 0,!r&&r!==0||!String(r).trim()){this.empty=!0;return}this.origin=String(r),this.number=Number(r)}return Ce(e,[{key:"negate",value:function(){return new e(-this.toNumber())}},{key:"add",value:function(t){if(this.isInvalidate())return new e(t);var u=Number(t);if(Number.isNaN(u))return this;var s=this.number+u;if(s>Number.MAX_SAFE_INTEGER)return new e(Number.MAX_SAFE_INTEGER);if(s<Number.MIN_SAFE_INTEGER)return new e(Number.MIN_SAFE_INTEGER);var c=Math.max(q(this.number),q(u));return new e(s.toFixed(c))}},{key:"isEmpty",value:function(){return this.empty}},{key:"isNaN",value:function(){return Number.isNaN(this.number)}},{key:"isInvalidate",value:function(){return this.isEmpty()||this.isNaN()}},{key:"equals",value:function(t){return this.toNumber()===(t==null?void 0:t.toNumber())}},{key:"lessEquals",value:function(t){return this.add(t.negate().toString()).toNumber()<=0}},{key:"toNumber",value:function(){return this.number}},{key:"toString",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return t?this.isInvalidate()?"":ne(this.number):this.origin}}]),e}(),Ze=function(){function e(r){if(_e(this,e),this.origin="",this.negative=void 0,this.integer=void 0,this.decimal=void 0,this.decimalLen=void 0,this.empty=void 0,this.nan=void 0,!r&&r!==0||!String(r).trim()){this.empty=!0;return}if(this.origin=String(r),r==="-"){this.nan=!0;return}var t=r;if(re(t)&&(t=Number(t)),t=typeof t=="string"?t:ne(t),ae(t)){var u=F(t);this.negative=u.negative;var s=u.trimStr.split(".");this.integer=BigInt(s[0]);var c=s[1]||"0";this.decimal=BigInt(c),this.decimalLen=c.length}else this.nan=!0}return Ce(e,[{key:"getMark",value:function(){return this.negative?"-":""}},{key:"getIntegerStr",value:function(){return this.integer.toString()}},{key:"getDecimalStr",value:function(){return this.decimal.toString().padStart(this.decimalLen,"0")}},{key:"alignDecimal",value:function(t){var u="".concat(this.getMark()).concat(this.getIntegerStr()).concat(this.getDecimalStr().padEnd(t,"0"));return BigInt(u)}},{key:"negate",value:function(){var t=new e(this.toString());return t.negative=!t.negative,t}},{key:"add",value:function(t){if(this.isInvalidate())return new e(t);var u=new e(t);if(u.isInvalidate())return this;var s=Math.max(this.getDecimalStr().length,u.getDecimalStr().length),c=this.alignDecimal(s),m=u.alignDecimal(s),f=(c+m).toString(),g=F(f),N=g.negativeStr,v=g.trimStr,p="".concat(N).concat(v.padStart(s+1,"0"));return new e("".concat(p.slice(0,-s),".").concat(p.slice(-s)))}},{key:"isEmpty",value:function(){return this.empty}},{key:"isNaN",value:function(){return this.nan}},{key:"isInvalidate",value:function(){return this.isEmpty()||this.isNaN()}},{key:"equals",value:function(t){return this.toString()===(t==null?void 0:t.toString())}},{key:"lessEquals",value:function(t){return this.add(t.negate().toString()).toNumber()<=0}},{key:"toNumber",value:function(){return this.isNaN()?NaN:Number(this.toString())}},{key:"toString",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return t?this.isInvalidate()?"":F("".concat(this.getMark()).concat(this.getIntegerStr(),".").concat(this.getDecimalStr())).fullStr:this.origin}}]),e}();function b(e){return ee()?new Ze(e):new Qe(e)}function te(e,r,t){if(e==="")return"";var u=F(e),s=u.negativeStr,c=u.integerStr,m=u.decimalStr,f="".concat(r).concat(m),g="".concat(s).concat(c);if(t>=0){var N=Number(m[t]);if(N>=5){var v=b(e).add("".concat(s,"0.").concat("0".repeat(t)).concat(10-N));return te(v.toString(),r,t)}return t===0?g:"".concat(g).concat(r).concat(m.padEnd(t,"0").slice(0,t))}return f===".0"?g:"".concat(g).concat(f)}var et=200,tt=600;function rt(e){var r=e.prefixCls,t=e.upNode,u=e.downNode,s=e.upDisabled,c=e.downDisabled,m=e.onStep,f=i.exports.useRef(),g=i.exports.useRef();g.current=m;var N=function(y,$){y.preventDefault(),g.current($);function k(){g.current($),f.current=setTimeout(k,et)}f.current=setTimeout(k,tt)},v=function(){clearTimeout(f.current)};if(i.exports.useEffect(function(){return v},[]),je())return null;var p="".concat(r,"-handler"),S=Z(p,"".concat(p,"-up"),x({},"".concat(p,"-up-disabled"),s)),E=Z(p,"".concat(p,"-down"),x({},"".concat(p,"-down-disabled"),c)),D={unselectable:"on",role:"button",onMouseUp:v,onMouseLeave:v};return i.exports.createElement("div",{className:"".concat(p,"-wrap")},i.exports.createElement("span",Q({},D,{onMouseDown:function(y){N(y,!0)},"aria-label":"Increase Value","aria-disabled":s,className:S}),t||i.exports.createElement("span",{unselectable:"on",className:"".concat(r,"-handler-up-inner")})),i.exports.createElement("span",Q({},D,{onMouseDown:function(y){N(y,!1)},"aria-label":"Decrease Value","aria-disabled":c,className:E}),u||i.exports.createElement("span",{unselectable:"on",className:"".concat(r,"-handler-down-inner")})))}function nt(e,r){var t=i.exports.useRef(null);function u(){try{var c=e.selectionStart,m=e.selectionEnd,f=e.value,g=f.substring(0,c),N=f.substring(m);t.current={start:c,end:m,value:f,beforeTxt:g,afterTxt:N}}catch{}}function s(){if(e&&t.current&&r)try{var c=e.value,m=t.current,f=m.beforeTxt,g=m.afterTxt,N=m.start,v=c.length;if(c.endsWith(g))v=c.length-t.current.afterTxt.length;else if(c.startsWith(f))v=f.length;else{var p=f[N-1],S=c.indexOf(p,N-1);S!==-1&&(v=S+1)}e.setSelectionRange(v,v)}catch(E){Ye(!1,"Something warning of cursor restore. Please fire issue about this: ".concat(E.message))}}return[u,s]}var at=ze()?i.exports.useLayoutEffect:i.exports.useEffect;function J(e,r){var t=i.exports.useRef(!1);at(function(){if(!t.current){t.current=!0;return}return e()},r)}var it=function(){var e=i.exports.useRef(0),r=function(){De.cancel(e.current)};return i.exports.useEffect(function(){return r},[]),function(t){r(),e.current=De(function(){t()})}},ut=["prefixCls","className","style","min","max","step","defaultValue","value","disabled","readOnly","upHandler","downHandler","keyboard","controls","stringMode","parser","formatter","precision","decimalSeparator","onChange","onInput","onPressEnter","onStep"],we=function(r,t){return r||t.isEmpty()?t.toString():t.toNumber()},Re=function(r){var t=b(r);return t.isInvalidate()?null:t},st=i.exports.forwardRef(function(e,r){var t,u=e.prefixCls,s=u===void 0?"rc-input-number":u,c=e.className,m=e.style,f=e.min,g=e.max,N=e.step,v=N===void 0?1:N,p=e.defaultValue,S=e.value,E=e.disabled,D=e.readOnly,_=e.upHandler,y=e.downHandler,$=e.keyboard,k=e.controls,ke=k===void 0?!0:k,ie=e.stringMode,U=e.parser,V=e.formatter,B=e.precision,w=e.decimalSeparator,G=e.onChange,K=e.onInput,W=e.onPressEnter,X=e.onStep,Ve=We(e,ut),ue="".concat(s,"-input"),P=i.exports.useRef(null),Me=i.exports.useState(!1),se=L(Me,2),oe=se[0],le=se[1],I=i.exports.useRef(!1),M=i.exports.useRef(!1),Ae=i.exports.useState(function(){return b(S!=null?S:p)}),ce=L(Ae,2),d=ce[0],fe=ce[1];function Te(a){S===void 0&&fe(a)}var j=i.exports.useCallback(function(a,n){if(!n)return B>=0?B:Math.max(q(a),q(v))},[B,v]),Y=i.exports.useCallback(function(a){var n=String(a);if(U)return U(n);var l=n;return w&&(l=l.replace(w,".")),l.replace(/[^\w.-]+/g,"")},[U,w]),de=i.exports.useRef(""),ve=i.exports.useCallback(function(a,n){if(V)return V(a,{userTyping:n,input:String(de.current)});var l=typeof a=="number"?ne(a):a;if(!n){var o=j(l,n);if(ae(l)&&(w||o>=0)){var h=w||".";l=te(l,h,o)}}return l},[V,j,w]),Fe=i.exports.useState(function(){var a=p!=null?p:S;return d.isInvalidate()&&["string","number"].includes(Xe(a))?Number.isNaN(a)?"":a:ve(d.toString(),!1)}),me=L(Fe,2),A=me[0],ge=me[1];de.current=A;function T(a,n){ge(ve(a.isInvalidate()?a.toString(!1):a.toString(!n),n))}var R=i.exports.useMemo(function(){return Re(g)},[g]),C=i.exports.useMemo(function(){return Re(f)},[f]),pe=i.exports.useMemo(function(){return!R||!d||d.isInvalidate()?!1:R.lessEquals(d)},[R,d]),Ne=i.exports.useMemo(function(){return!C||!d||d.isInvalidate()?!1:d.lessEquals(C)},[C,d]),qe=nt(P.current,oe),Se=L(qe,2),$e=Se[0],Ue=Se[1],he=function(n){return R&&!n.lessEquals(R)?R:C&&!C.lessEquals(n)?C:null},be=function(n){return!he(n)},z=function(n,l){var o=n,h=be(o)||o.isEmpty();if(!o.isEmpty()&&!l&&(o=he(o)||o,h=!0),!D&&!E&&h){var H=o.toString(),xe=j(H,l);return xe>=0&&(o=b(te(H,".",xe))),o.equals(d)||(Te(o),G==null||G(o.isEmpty()?null:we(ie,o)),S===void 0&&T(o,l)),o}return d},Be=it(),Ee=function a(n){if($e(),ge(n),!M.current){var l=Y(n),o=b(l);o.isNaN()||z(o,!0)}K==null||K(n),Be(function(){var h=n;U||(h=n.replace(/ã€‚/g,".")),h!==n&&a(h)})},Pe=function(){M.current=!0},He=function(){M.current=!1,Ee(P.current.value)},Le=function(n){Ee(n.target.value)},ye=function(n){var l;if(!(n&&pe||!n&&Ne)){I.current=!1;var o=b(v);n||(o=o.negate());var h=(d||b(0)).add(o.toString()),H=z(h,!1);X==null||X(we(ie,H),{offset:v,type:n?"up":"down"}),(l=P.current)===null||l===void 0||l.focus()}},Ie=function(n){var l=b(Y(A)),o=l;l.isNaN()?o=d:o=z(l,n),S!==void 0?T(d,!1):o.isNaN()||T(o,!1)},Oe=function(n){var l=n.which;I.current=!0,l===O.ENTER&&(M.current||(I.current=!1),Ie(!1),W==null||W(n)),$!==!1&&!M.current&&[O.UP,O.DOWN].includes(l)&&(ye(O.UP===l),n.preventDefault())},Ge=function(){I.current=!1},Ke=function(){Ie(!1),le(!1),I.current=!1};return J(function(){d.isInvalidate()||T(d,!1)},[B]),J(function(){var a=b(S);fe(a);var n=b(Y(A));(!a.equals(n)||!I.current||V)&&T(a,I.current)},[S]),J(function(){V&&Ue()},[A]),i.exports.createElement("div",{className:Z(s,c,(t={},x(t,"".concat(s,"-focused"),oe),x(t,"".concat(s,"-disabled"),E),x(t,"".concat(s,"-readonly"),D),x(t,"".concat(s,"-not-a-number"),d.isNaN()),x(t,"".concat(s,"-out-of-range"),!d.isInvalidate()&&!be(d)),t)),style:m,onFocus:function(){le(!0)},onBlur:Ke,onKeyDown:Oe,onKeyUp:Ge,onCompositionStart:Pe,onCompositionEnd:He},ke&&i.exports.createElement(rt,{prefixCls:s,upNode:_,downNode:y,upDisabled:pe,downDisabled:Ne,onStep:ye}),i.exports.createElement("div",{className:"".concat(ue,"-wrap")},i.exports.createElement("input",Q({autoComplete:"off",role:"spinbutton","aria-valuemin":f,"aria-valuemax":g,"aria-valuenow":d.isInvalidate()?null:d.toString(),step:v},Ve,{ref:Je(P,r),className:ue,value:A,onChange:Le,disabled:E,readOnly:D}))))});st.displayName="InputNumber";export{st as I};
