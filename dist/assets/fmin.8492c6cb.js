function O(n,e,r,f){f=f||{};var o=f.maxIterations||100,l=f.tolerance||1e-10,u=n(e),m=n(r),t=r-e;if(u*m>0)throw"Initial bisect points must have opposite signs";if(u===0)return e;if(m===0)return r;for(var s=0;s<o;++s){t/=2;var c=e+t,h=n(c);if(h*u>=0&&(e=c),Math.abs(t)<l||h===0)return c}return e+t}function B(n){for(var e=new Array(n),r=0;r<n;++r)e[r]=0;return e}function T(n,e){return B(n).map(function(){return B(e)})}function A(n,e){for(var r=0,f=0;f<n.length;++f)r+=n[f]*e[f];return r}function L(n){return Math.sqrt(A(n,n))}function G(n,e,r){for(var f=0;f<e.length;++f)n[f]=e[f]*r}function M(n,e,r,f,o){for(var l=0;l<n.length;++l)n[l]=e*r[l]+f*o[l]}function w(n,e,r){r=r||{};var f=r.maxIterations||e.length*200,o=r.nonZeroDelta||1.05,l=r.zeroDelta||.001,u=r.minErrorDelta||1e-6,m=r.minErrorDelta||1e-5,t=r.rho!==void 0?r.rho:1,s=r.chi!==void 0?r.chi:2,c=r.psi!==void 0?r.psi:-.5,h=r.sigma!==void 0?r.sigma:.5,p,v=e.length,x=new Array(v+1);x[0]=e,x[0].fx=n(e),x[0].id=0;for(var i=0;i<v;++i){var g=e.slice();g[i]=g[i]?g[i]*o:l,x[i+1]=g,x[i+1].fx=n(g),x[i+1].id=i+1}function D(a){for(var d=0;d<a.length;d++)x[v][d]=a[d];x[v].fx=a.fx}for(var E=function(a,d){return a.fx-d.fx},I=e.slice(),b=e.slice(),y=e.slice(),P=e.slice(),k=0;k<f;++k){if(x.sort(E),r.history){var q=x.map(function(a){var d=a.slice();return d.fx=a.fx,d.id=a.id,d});q.sort(function(a,d){return a.id-d.id}),r.history.push({x:x[0].slice(),fx:x[0].fx,simplex:q})}for(p=0,i=0;i<v;++i)p=Math.max(p,Math.abs(x[0][i]-x[1][i]));if(Math.abs(x[0].fx-x[v].fx)<u&&p<m)break;for(i=0;i<v;++i){I[i]=0;for(var S=0;S<v;++S)I[i]+=x[S][i];I[i]/=v}var z=x[v];if(M(b,1+t,I,-t,z),b.fx=n(b),b.fx<x[0].fx)M(P,1+s,I,-s,z),P.fx=n(P),P.fx<b.fx?D(P):D(b);else if(b.fx>=x[v-1].fx){var Z=!1;if(b.fx>z.fx?(M(y,1+c,I,-c,z),y.fx=n(y),y.fx<z.fx?D(y):Z=!0):(M(y,1-c*t,I,c*t,z),y.fx=n(y),y.fx<b.fx?D(y):Z=!0),Z){if(h>=1)break;for(i=1;i<x.length;++i)M(x[i],1-h,x[0],h,x[i]),x[i].fx=n(x[i])}}else D(b)}return x.sort(E),{fx:x[0].fx,x:x[0]}}function N(n,e,r,f,o,l,u){var m=r.fx,t=A(r.fxprime,e),s=m,c=m,h=t,p=0;o=o||1,l=l||1e-6,u=u||.1;function v(i,g,D){for(var E=0;E<16;++E)if(o=(i+g)/2,M(f.x,1,r.x,o,e),s=f.fx=n(f.x,f.fxprime),h=A(f.fxprime,e),s>m+l*o*t||s>=D)g=o;else{if(Math.abs(h)<=-u*t)return o;h*(g-i)>=0&&(g=i),i=o,D=s}return 0}for(var x=0;x<10;++x){if(M(f.x,1,r.x,o,e),s=f.fx=n(f.x,f.fxprime),h=A(f.fxprime,e),s>m+l*o*t||x&&s>=c)return v(p,o,c);if(Math.abs(h)<=-u*t)return o;if(h>=0)return v(o,p,s);c=s,p=o,o*=2}return o}function C(n,e,r){var f={x:e.slice(),fx:0,fxprime:e.slice()},o={x:e.slice(),fx:0,fxprime:e.slice()},l=e.slice(),u,m,t=1,s;r=r||{},s=r.maxIterations||e.length*20,f.fx=n(f.x,f.fxprime),u=f.fxprime.slice(),G(u,f.fxprime,-1);for(var c=0;c<s;++c){if(t=N(n,u,f,o,t),r.history&&r.history.push({x:f.x.slice(),fx:f.fx,fxprime:f.fxprime.slice(),alpha:t}),!t)G(u,f.fxprime,-1);else{M(l,1,o.fxprime,-1,f.fxprime);var h=A(f.fxprime,f.fxprime),p=Math.max(0,A(l,o.fxprime)/h);M(u,p,u,-1,o.fxprime),m=f,f=o,o=m}if(L(f.fxprime)<=1e-5)break}return r.history&&r.history.push({x:f.x.slice(),fx:f.fx,fxprime:f.fxprime.slice(),alpha:t}),f}export{L as a,O as b,C as c,T as d,w as n,G as s,B as z};
